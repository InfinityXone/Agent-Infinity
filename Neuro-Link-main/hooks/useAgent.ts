// shared logic for agent actions